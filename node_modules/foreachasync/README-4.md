forEachAsync
===

Analogous to `[].forEach`, but handles items asynchronously with a final callback passed to `then`.

This is the most essential piece of the [`ArrayAsync`](https://github.com/FuturesJS/ArrayAsync) package.

Browser Installation
===

You can install from bower:

```bash
bower install forEachAsync
```

Or download the raw file from <https://raw.github.com/FuturesJS/forEachAsync/master/forEachAsync.js>:

```bash
wget https://raw.github.com/FuturesJS/forEachAsync/master/forEachAsync.js
```

```javascript
(function () {
  'use strict';

  var forEachAsync = window.forEachAsync
    ;

  // do stuff ...
}());
```

If you need both 3.x and 4.x version of `forEachAsync` in the browser... don't do that...
```

Node Installation
===

```bash
npm install --save forEachAsync@4.x
```


v4.x - Promise Edition
===

This backwards-compatible version works with Promises and callbacks.

You can use `resolve` as you would have used `next` previously, or you can return a promise of your own.

Usage (with Promises)
-----

```javascript
  // EXAMPLE ASYNC FUNCTION (node)
  function getPicsAsync(animal) {
    var flickerApi = "http://api.flickr.com/services/feeds/photos_public.gne?tagmode=any&format=json&tags=" + animal;

    return requestAsync({ url: flickerApi });
  }
```

```javascript
  forEachAsync(['dogs', 'cats', 'octocats'], function (resolve, element) {
    return getPicsAsync(element);
  }).then(function () {
    // then after all of the elements have been handled
    // the final callback fires to let you know it's all done
    console.log('All requests have finished');
  });
```


If you need reject, it's the last parameter

```javascript
  forEachAsync(['dogs', 'cats', 'octocats'], function (resolve, element, index, array, reject) {
  });
```

Usage (without Promises)
-----

Let's say you have a function that gets pictures from the flickr api that's something like this:

```javascript
  // EXAMPLE ASYNC FUNCTION (browser)

  function getPics(animal, cb) {
    var flickerApi = "http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?";

    $.getJSON(
      flickerApi
    , { tags: animal
      , tagmode: "any"
      , format: "json"
      , success: function (data) {
          console.log('teh animals:', data);
        }
      , complete: cb
      }
    );
  }
```

You would use `forEachAsync` like this:

```javascript
  // waits for one request to finish before beginning the next
  forEachAsync(['dogs', 'cats', 'octocats'], function (resolve, element) {
    return new Promise(function (resolve) {
      getPics(element, resolve);
    })
  }).then(function () {
    // then after all of the elements have been handled
    // the final callback fires to let you know it's all done
    console.log('All requests have finished');
  });
```

API
===

**`forEachAsync(array, callback[, thisArg])`**

Parameters

  * `array` Array of elements to iterate over
  * `callback` Function to execute for each element, takes 4 arguments
    * `resolve` if you don't return a Promise, you must use this as your callback
    * `element` a single element of the aforementioned array
    * `index` the index of the current element
    * `array` the same array mentioned above
  * `thisArg` Object to use as `this` when executing `callback`

**`forEachAsync#then(done)`**

Parameters

  * `then` is in the return value of `forEachAsync` and accepts a final `done` callback.
    * `done` called after `forEachAsync` is complete, takes no arguments

Internal API
===

`forEachAsync.__BREAK`

This is used internally for the purposes of the `ArrayAsync` library.

Please don't `break` stuff; use [`ArrayAsync`](https://github.com/FuturesJS/ArrayAsync)`.someAsync` or [`ArrayAsync`](https://github.com/FuturesJS/ArrayAsync)`.everyAsync` instead.
